(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3276],{956:(e,t,a)=>{"use strict";a.d(t,{c:()=>n});var s=a(44598),r=a(80644);function n(e){var t=(0,s.A)(e);return+(0,r.o)(e)==+(0,r.o)(t)}},8376:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(40157).A)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},12543:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(40157).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},20268:(e,t,a)=>{Promise.resolve().then(a.bind(a,63949))},24371:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(40157).A)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},30356:(e,t,a)=>{"use strict";a.d(t,{C:()=>c,z:()=>d});var s=a(95155),r=a(12115),n=a(54059),l=a(70154),i=a(59434);let d=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.bL,{className:(0,i.cn)("grid gap-2",a),...r,ref:t})});d.displayName=n.bL.displayName;let c=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.q7,{ref:t,className:(0,i.cn)("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a),...r,children:(0,s.jsx)(n.C1,{className:"flex items-center justify-center",children:(0,s.jsx)(l.A,{className:"h-2.5 w-2.5 fill-current text-current"})})})});c.displayName=n.q7.displayName},44598:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});var s=a(92084);function r(e){return(0,s.w)(e,Date.now())}},44642:(e,t,a)=>{"use strict";a.d(t,{MI:()=>m,kh:()=>f,np:()=>p});var s=a(95155),r=a(34548),n=a(30347),l=a(60922),i=a(35317),d=a(4382);let c={review_word:5,spell_correct:5,daily_login:20,master_word:10,grammar_test:20},o=e=>({timeSpentSeconds:0,totalWordsReviewed:0,xp:0,reviewedToday:{count:0,date:e,timeSpentSeconds:0,completedTests:[]},activityLog:[],spellingPractice:{count:0,date:e},lastLoginDate:"1970-01-01",weekStartDate:(0,r.k)(new Date,{weekStartsOn:1}).toISOString(),lastWeek:null,hasSeenLastWeekResults:!0});async function u(e){let t=query((0,i.rJ)(d.db,"users"),where("supervisorId","==",e)),a=await (0,i.GG)(t);return await Promise.all(a.docs.map(async e=>{let t={...e.data(),id:e.id},a=await m(t.id);return{user:t,stats:a}}))}let m=async e=>{var t,a;let s,l,c=new Date,m=c.toLocaleDateString("en-CA"),f=(0,r.k)(c,{weekStartsOn:1}),p="".concat(c.getFullYear(),"-").concat((0,n.N)(c,{weekStartsOn:1})),h=(0,i.H9)(d.db,"users/".concat(e,"/app-data/stats")),w=await (0,i.x7)(h);w.exists()?s=w.data():(s=o(m),await (0,i.BN)(h,s)),"number"!=typeof s.xp&&(s.xp=0),s.lastLoginDate||(s.lastLoginDate="1970-01-01"),s.weekStartDate||(s.weekStartDate=f.toISOString()),"boolean"!=typeof s.hasSeenLastWeekResults&&(s.hasSeenLastWeekResults=!0);let g=new Date(s.weekStartDate),y="".concat(g.getFullYear(),"-").concat((0,n.N)(g,{weekStartsOn:1}));if(p!==y&&!(null==(a=s.lastWeek)||null==(t=a.weekId)?void 0:t.endsWith(y))&&(null==(l=await x(e))?void 0:l.supervisorId)){let e=await u(l.supervisorId),t=e.map(e=>{let{user:t,stats:a}=e;return{...t,xp:a.xp}}).sort((e,t)=>t.xp-e.xp).slice(0,3).map((e,t)=>({id:e.id,name:e.name,avatar:e.avatar,xp:e.xp,rank:t+1}));for(let{user:a}of e){let e=(0,i.H9)(d.db,"users/".concat(a.id,"/app-data/stats"));await (0,i.BN)(e,{xp:0,weekStartDate:f.toISOString(),lastWeek:{weekId:y,winners:t},hasSeenLastWeekResults:!1},{merge:!0})}let a=await (0,i.x7)(h);a.exists()&&(s=a.data())}return s.reviewedToday&&s.reviewedToday.date===m||(s.reviewedToday={count:0,date:m,timeSpentSeconds:0,completedTests:[]}),s.spellingPractice&&s.spellingPractice.date===m||(s.spellingPractice={count:0,date:m}),Array.isArray(s.activityLog)||(s.activityLog=[]),Array.isArray(s.reviewedToday.completedTests)||(s.reviewedToday.completedTests=[]),"number"!=typeof s.reviewedToday.timeSpentSeconds&&(s.reviewedToday.timeSpentSeconds=0),s},f=async(e,t)=>{if(!e)return{updated:!1,amount:0};let a=await m(e),s=c[t],r=new Date().toLocaleDateString("en-CA");if("daily_login"===t){if(a.lastLoginDate===r)return{updated:!1,amount:0};a.lastLoginDate=r}a.xp+=s;let n=(0,i.H9)(d.db,"users/".concat(e,"/app-data/stats"));return await (0,i.BN)(n,a,{merge:!0}),{updated:!0,amount:s}},p=async e=>{let{userId:t,reviewedCount:a=0,durationSeconds:r=0,testName:n,spelledCount:o=0,toast:u,markAsSeen:f=!1}=e;if(!t)return;let p=await m(t),x=new Date().toLocaleDateString("en-CA");p.totalWordsReviewed+=a,p.timeSpentSeconds+=r,p.reviewedToday.count+=a,p.reviewedToday.timeSpentSeconds+=r,p.spellingPractice.count+=o,p.activityLog.includes(x)||p.activityLog.push(x),n&&!p.reviewedToday.completedTests.includes(n)&&(p.reviewedToday.completedTests.push(n),p.xp+=c.grammar_test,u&&u({description:(0,s.jsx)(l.Y,{event:"grammar_test",amount:c.grammar_test}),duration:3e3})),f&&(p.hasSeenLastWeekResults=!0);let h=(0,i.H9)(d.db,"users/".concat(t,"/app-data/stats"));await (0,i.BN)(h,p,{merge:!0})};async function x(e){if(!e)return;let t=(0,i.H9)(d.db,"users",e),a=await (0,i.x7)(t);if(!a.exists())return;let s=a.data();return s.trialExpiresAt&&s.trialExpiresAt instanceof Timestamp&&(s.trialExpiresAt=s.trialExpiresAt.toDate().toISOString()),{...s,id:a.id}}},50514:(e,t,a)=>{"use strict";a.d(t,{Q:()=>r});var s=a(9086);let r=async(e,t,a)=>{if(!e||!t)return;let r={id:t,studentId:e,strength:a.strength,nextReview:a.nextReview};try{await (0,s.i2)(e,[r])}catch(e){console.error("Failed to update student progress in Firestore",e)}}},59434:(e,t,a)=>{"use strict";a.d(t,{cn:()=>n});var s=a(52596),r=a(39688);function n(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,r.QP)((0,s.$)(t))}},60922:(e,t,a)=>{"use strict";a.d(t,{Y:()=>u});var s=a(95155),r=a(31550),n=a(77724),l=a(51920),i=a(85268),d=a(30462),c=a(20794);let o={review_word:(0,s.jsx)(r.A,{className:"h-5 w-5 text-green-500"}),spell_correct:(0,s.jsx)(n.A,{className:"h-5 w-5 text-green-500"}),daily_login:(0,s.jsx)(l.A,{className:"h-5 w-5 text-green-500"}),master_word:(0,s.jsx)(i.A,{className:"h-5 w-5 text-yellow-500"}),grammar_test:(0,s.jsx)(i.A,{className:"h-5 w-5 text-yellow-500"})};function u(e){let{event:t,amount:a}=e,{t:r}=(0,c.o)(),n=r("xpEvents.".concat(t)),l=o[t];return(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[l,(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"font-semibold",children:n}),(0,s.jsxs)("span",{className:"flex items-center gap-1 text-sm text-yellow-500 font-bold",children:["+",a," XP",(0,s.jsx)(d.A,{className:"h-4 w-4 fill-current"})]})]})]})}},63949:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>D});var s=a(95155),r=a(12115),n=a(35695),l=a(9086),i=a(66695),d=a(66766),c=a(30356),o=a(85057),u=a(30285),m=a(59434),f=a(8376),p=a(24371),x=a(51920),h=a(30462),w=a(20794);function g(e){let{word:t,onCorrect:a,onIncorrect:n}=e,[l,g]=(0,r.useState)(null),[y,v]=(0,r.useState)("question"),[j,N]=(0,r.useState)(!1),[b,S]=(0,r.useState)([]),{t:k}=(0,w.o)(),[A,D]=(0,r.useState)(!1);(0,r.useEffect)(()=>{S([...t.options].sort(()=>Math.random()-.5)),g(null),v("question"),N(!1),D(!1)},[t]);let T=e=>"feedback"!==y?"default":e===t.correctOption?"correct":e===l&&e!==t.correctOption?"incorrect":"default",C=e=>{switch(e){case"correct":return"text-green-500";case"incorrect":return"text-destructive";default:return"text-primary"}},_=e=>{A||(D(!0),a(e))},I=()=>{let e=t.strength||0;return e<=1?"tomorrow":2===e?"twoDays":3===e?"week":4===e?"twoWeeks":"month"};return(0,s.jsxs)(i.Zp,{className:"w-full",children:[(0,s.jsx)(i.aR,{children:(0,s.jsx)(i.ZB,{className:"text-center text-4xl font-headline flex items-center justify-center gap-4",children:(0,s.jsx)("span",{children:t.definition})})}),"schedule"===y?(()=>{let e=I(),a=[{key:"tomorrow",label:k("quizCard.schedule.tomorrow")},{key:"twoDays",label:k("quizCard.schedule.inTwoDays")},{key:"week",label:k("quizCard.schedule.inAWeek")},{key:"twoWeeks",label:k("quizCard.schedule.inTwoWeeks")},{key:"month",label:k("quizCard.schedule.inAMonth")}];return(0,s.jsxs)(i.Wu,{className:"flex flex-col items-center justify-center space-y-4 pt-6",children:[(0,s.jsx)("div",{className:"flex justify-center mb-4",children:(0,s.jsx)(d.default,{src:t.imageUrl,alt:"Image for ".concat(t.word),width:150,height:100,className:"rounded-lg object-cover"})}),(0,s.jsx)("h3",{className:"text-xl font-semibold",children:k("quizCard.schedule.title")}),(0,s.jsx)("p",{className:"text-muted-foreground",children:k("quizCard.schedule.description")}),(0,s.jsxs)("div",{className:"w-full space-y-2",children:[a.map(t=>{let{key:a,label:r}=t,n=a===e;return(0,s.jsxs)(u.$,{onClick:()=>_(a),variant:n?"default":"outline",className:"w-full justify-start relative",disabled:A,children:[(0,s.jsx)(x.A,{className:"mr-2 h-4 w-4"}),r,n&&(0,s.jsx)("span",{className:"absolute right-2 text-xs bg-primary-foreground/20 text-white py-0.5 px-1.5 rounded-full",children:k("quizCard.schedule.recommended")})]},a)}),(0,s.jsxs)(u.$,{onClick:()=>_("mastered"),variant:"secondary",className:"w-full justify-start",disabled:A,children:[(0,s.jsx)(h.A,{className:"mr-2 h-4 w-4"}),k("quizCard.schedule.mastered")]})]})]})})():(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(i.Wu,{className:"space-y-6",children:[(0,s.jsx)("div",{className:"flex justify-center",children:(0,s.jsx)(d.default,{src:t.imageUrl,alt:"Image for ".concat(t.word),width:300,height:200,className:"rounded-lg object-cover"})}),(0,s.jsx)(c.z,{value:l||"",onValueChange:g,disabled:"question"!==y,children:(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:b.map(e=>{let t=T(e);return(0,s.jsxs)(o.J,{className:(0,m.cn)("flex items-center space-x-3 rounded-lg border p-4 cursor-pointer transition-all","correct"===t&&"border-green-500 bg-green-500/10","incorrect"===t&&"border-destructive bg-destructive/10","question"===y&&l===e&&"border-primary bg-primary/10"),children:[(0,s.jsx)(c.C,{value:e,id:e,className:C(t)}),(0,s.jsx)("span",{className:"font-medium text-base",children:e}),"correct"===t&&(0,s.jsx)(f.A,{className:"ml-auto h-5 w-5 text-green-500"}),"incorrect"===t&&(0,s.jsx)(p.A,{className:"ml-auto h-5 w-5 text-destructive"})]},e)})})})]}),(0,s.jsx)(i.wL,{className:"flex justify-center",children:(0,s.jsx)(u.$,{onClick:()=>{if(!l)return;let e=l===t.correctOption;N(e),v("feedback"),setTimeout(()=>{e?v("schedule"):n()},1500)},disabled:!l||"question"!==y,className:"w-full",children:k("quizCard.checkAnswer")})})]})]})}var y=a(50514),v=a(73844),j=a(6874),N=a.n(j),b=a(12543),S=a(44642),k=a(87481),A=a(60922);function D(){let e=(0,n.useSearchParams)(),{t}=(0,w.o)(),{toast:a}=(0,k.dj)(),[i,d]=(0,r.useState)(null),[c,o]=(0,r.useState)(!1),m=(0,r.useRef)(null),f=e.get("userId"),p=(0,r.useCallback)(async()=>{if(f){let e=await (0,l.CH)(f,null,null,"today");d(e),e||o(!0)}},[f]),x=(0,r.useCallback)(async(e,t)=>{f&&await (0,S.np)({userId:f,reviewedCount:e,durationSeconds:t})},[f]);(0,r.useEffect)(()=>{m.current=Date.now(),p();let e=()=>{if(f&&m.current){let e=Math.round((Date.now()-m.current)/1e3);e>0&&x(0,e),m.current=null}};return window.addEventListener("beforeunload",e),()=>{e(),window.removeEventListener("beforeunload",e)}},[f,p,x]);let h=async e=>{if(!i||!f)return;let t=i.strength>=0?i.strength+1:1,r=new Date,n="review_word";switch(e){case"tomorrow":r.setDate(r.getDate()+1);break;case"twoDays":r.setDate(r.getDate()+2);break;case"week":r.setDate(r.getDate()+7);break;case"twoWeeks":r.setDate(r.getDate()+14);break;case"month":r.setMonth(r.getMonth()+1);break;case"mastered":t=-1,n="master_word"}await (0,y.Q)(f,i.id,{strength:t,nextReview:r}),await x(1,0);let{amount:l}=await (0,S.kh)(f,n);a({description:(0,s.jsx)(A.Y,{event:n,amount:l}),duration:3e3}),p()},j=async()=>{if(!i||!f)return;let e=Math.max(0,i.strength-1),t=new Date;t.setDate(t.getDate()+1),await (0,y.Q)(f,i.id,{strength:e,nextReview:t}),await x(1,0);let{amount:r}=await (0,S.kh)(f,"review_word");a({description:(0,s.jsx)(A.Y,{event:"review_word",amount:r}),duration:3e3}),p()};return f?(0,s.jsx)(v.Y,{children:(0,s.jsx)("div",{className:"flex flex-col items-center justify-center min-h-screen p-4 bg-secondary",children:(0,s.jsxs)("div",{className:"w-full max-w-2xl",children:[(0,s.jsx)(u.$,{variant:"secondary",size:"icon",asChild:!0,className:"absolute top-4 left-4 rounded-full",children:(0,s.jsxs)(N(),{href:"/dashboard?userId=".concat(f),children:[(0,s.jsx)(b.A,{className:"h-5 w-5"}),(0,s.jsx)("span",{className:"sr-only",children:t("learn.backToDashboard")})]})}),c?(0,s.jsxs)("div",{className:"text-center p-8 bg-card rounded-lg shadow-lg",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold font-headline mb-4",children:t("learn.sessionFinished.title")}),(0,s.jsx)("p",{className:"text-muted-foreground mb-6",children:t("learn.sessionFinished.description")}),(0,s.jsx)(u.$,{asChild:!0,children:(0,s.jsx)(N(),{href:"/dashboard?userId=".concat(f),children:t("learn.backToDashboard")})})]}):i?(0,s.jsx)(g,{word:i,onCorrect:h,onIncorrect:j},i.id):(0,s.jsx)("div",{className:"text-center",children:(0,s.jsx)("p",{children:t("dashboard.loading")})})]})})}):(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:"User not found. Please log in again."})}},66695:(e,t,a)=>{"use strict";a.d(t,{BT:()=>c,Wu:()=>o,ZB:()=>d,Zp:()=>l,aR:()=>i,wL:()=>u});var s=a(95155),r=a(12115),n=a(59434);let l=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...r})});l.displayName="Card";let i=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",a),...r})});i.displayName="CardHeader";let d=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",a),...r})});d.displayName="CardTitle";let c=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",a),...r})});c.displayName="CardDescription";let o=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",a),...r})});o.displayName="CardContent";let u=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",a),...r})});u.displayName="CardFooter"},73844:(e,t,a)=>{"use strict";a.d(t,{Y:()=>n});var s=a(95155),r=a(12115);function n(e){let{children:t}=e,[a,n]=(0,r.useState)(!1);return((0,r.useEffect)(()=>{n(!0)},[]),a)?(0,s.jsx)(s.Fragment,{children:t}):null}},78039:(e,t,a)=>{"use strict";a.d(t,{P:()=>n});var s=a(35476),r=a(92084);function n(e,t){let a=(0,s.a)(e);if(isNaN(t))return(0,r.w)(e,NaN);if(!t)return a;let n=a.getDate(),l=(0,r.w)(e,a.getTime());return(l.setMonth(a.getMonth()+t+1,0),n>=l.getDate())?l:(a.setFullYear(l.getFullYear(),l.getMonth(),n),a)}},80644:(e,t,a)=>{"use strict";a.d(t,{o:()=>r});var s=a(35476);function r(e){let t=(0,s.a)(e);return t.setHours(0,0,0,0),t}},85057:(e,t,a)=>{"use strict";a.d(t,{J:()=>c});var s=a(95155),r=a(12115),n=a(40968),l=a(74466),i=a(59434);let d=(0,l.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.b,{ref:t,className:(0,i.cn)(d(),a),...r})});c.displayName=n.b.displayName},86622:(e,t,a)=>{"use strict";a.d(t,{e:()=>r});var s=a(78039);function r(e,t){return(0,s.P)(e,12*t)}},87481:(e,t,a)=>{"use strict";a.d(t,{dj:()=>m});var s=a(12115);let r=0,n=new Map,l=e=>{if(n.has(e))return;let t=setTimeout(()=>{n.delete(e),o({type:"REMOVE_TOAST",toastId:e})},5e3);n.set(e,t)},i=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:a}=t;return a?l(a):e.toasts.forEach(e=>{l(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===a||void 0===a?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},d=[],c={toasts:[]};function o(e){c=i(c,e),d.forEach(e=>{e(c)})}function u(e){let{...t}=e,a=(r=(r+1)%Number.MAX_SAFE_INTEGER).toString(),s=()=>o({type:"DISMISS_TOAST",toastId:a});return o({type:"ADD_TOAST",toast:{...t,id:a,open:!0,onOpenChange:e=>{e||s()}}}),{id:a,dismiss:s,update:e=>o({type:"UPDATE_TOAST",toast:{...e,id:a}})}}function m(){let[e,t]=s.useState(c);return s.useEffect(()=>(d.push(t),()=>{let e=d.indexOf(t);e>-1&&d.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>o({type:"DISMISS_TOAST",toastId:e})}}}},e=>{var t=t=>e(e.s=t);e.O(0,[2992,7416,4277,2557,3559,7414,6874,6766,1298,6551,794,1858,8441,1684,7358],()=>t(20268)),_N_E=e.O()}]);