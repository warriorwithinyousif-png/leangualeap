(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6795],{65841:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>v});var r=t(95155),n=t(12115),l=t(35695),a=t(32091),c=t(66695),i=t(30285),d=t(30356),o=t(85057),u=t(50172),h=t(67554),x=t(59434),m=t(55365),f=t(44642),j=t(87481);let p="Past Simple";function v(){let e=(0,l.useSearchParams)().get("userId"),[s,t]=(0,n.useState)(null),[v,b]=(0,n.useState)(!0),[g,N]=(0,n.useState)(null),[w,y]=(0,n.useState)({}),[k,E]=(0,n.useState)(!1),T=(0,n.useRef)(null),{toast:S}=(0,j.dj)(),C=(0,n.useCallback)(async(s,t)=>{e&&await (0,f.np)({userId:e,durationSeconds:s,testName:t,toast:S})},[e,S]);(0,n.useEffect)(()=>{T.current=Date.now();let e=()=>{if(T.current){let e=Math.round((Date.now()-T.current)/1e3);e>0&&C(e),T.current=null}};return window.addEventListener("beforeunload",e),()=>{e(),window.removeEventListener("beforeunload",e)}},[C]);let q=async()=>{b(!0),N(null),E(!1),y({});try{let e=await (0,a.U)({tense:p});if(e&&e.questions)t(e.questions);else throw Error("AI failed to generate quiz questions.")}catch(e){N(e instanceof Error?e.message:"An unknown error occurred.")}finally{b(!1)}};(0,n.useEffect)(()=>{q()},[]);let A=(e,s)=>{y(t=>({...t,[e]:s}))},_=(e,t)=>{if(!k)return"default";let r=t===s[e].correctOption,n=w[e]===t;return r?"correct":n&&!r?"incorrect":"default"};return v?(0,r.jsxs)("div",{className:"flex items-center justify-center h-full min-h-[400px]",children:[(0,r.jsx)(u.A,{className:"h-8 w-8 animate-spin text-primary"}),(0,r.jsx)("p",{className:"ml-4 text-muted-foreground",children:"Generating your quiz..."})]}):g?(0,r.jsxs)(m.Fc,{variant:"destructive",children:[(0,r.jsx)(m.XL,{children:"Error"}),(0,r.jsx)(m.TN,{children:g})]}):(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold font-headline",children:"Past Simple Test"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Test your knowledge. The questions are generated dynamically by AI."}),(0,r.jsx)("div",{className:"space-y-8",children:null==s?void 0:s.map((e,s)=>(0,r.jsxs)(c.Zp,{children:[(0,r.jsxs)(c.aR,{children:[(0,r.jsxs)(c.ZB,{children:["Question ",s+1]}),(0,r.jsx)(c.BT,{children:e.questionText})]}),(0,r.jsx)(c.Wu,{children:(0,r.jsx)(d.z,{value:w[s]||"",onValueChange:e=>A(s,e),disabled:k,children:(0,r.jsx)("div",{className:"space-y-2",children:e.options.map((e,t)=>{let n=_(s,e);return(0,r.jsxs)(o.J,{className:(0,x.cn)("flex items-center space-x-3 rounded-lg border p-3 transition-all",!k&&"cursor-pointer","correct"===n&&"border-green-500 bg-green-500/10 text-green-900 font-semibold","incorrect"===n&&"border-destructive bg-destructive/10 text-destructive font-semibold"),children:[(0,r.jsx)(d.C,{value:e,id:"".concat(s,"-").concat(t)}),(0,r.jsx)("span",{children:e})]},t)})})})})]},s))}),(0,r.jsx)("div",{className:"mt-8 flex justify-center gap-4",children:k?(0,r.jsxs)(c.Zp,{className:"p-6 text-center",children:[(0,r.jsx)(c.ZB,{children:"Test Complete!"}),(0,r.jsxs)(c.BT,{className:"mt-2",children:["You scored ",s?s.reduce((e,s,t)=>e+ +(w[t]===s.correctOption),0):0," out of ",null==s?void 0:s.length,"."]}),(0,r.jsxs)(i.$,{onClick:q,className:"mt-4",children:[(0,r.jsx)(h.A,{className:"mr-2 h-4 w-4"}),"Take a New Test"]})]}):(0,r.jsx)(i.$,{onClick:()=>{E(!0),C(0,p)},disabled:Object.keys(w).length!==(null==s?void 0:s.length),children:"Submit Answers"})})]})}},88877:(e,s,t)=>{Promise.resolve().then(t.bind(t,65841))}},e=>{var s=s=>e(e.s=s);e.O(0,[2992,7416,4277,2557,3559,7414,1298,6551,794,237,8441,1684,7358],()=>s(88877)),_N_E=e.O()}]);