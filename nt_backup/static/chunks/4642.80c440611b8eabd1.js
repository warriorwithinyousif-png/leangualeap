"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4642],{4637:(e,t,s)=>{s.d(t,{g:()=>i});var a=s(95155),r=s(59434);function i(e){let{className:t}=e;return(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:(0,r.cn)("h-8 w-8",t),children:[(0,a.jsx)("path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",className:"text-primary",fill:"hsl(var(--primary))",stroke:"hsl(var(--primary))"}),(0,a.jsx)("path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",className:"text-primary"})]})}},4642:(e,t,s)=>{s.r(t),s.d(t,{LoginForm:()=>A});var a=s(95155),r=s(6874),i=s.n(r),n=s(30285),o=s(66695),l=s(62523),d=s(85057),c=s(4637),u=s(12115),m=s(87481),p=s(4607),f=s(17607),h=s(50172),x=s(20794),g=s(70927),b=s(35695),w=s(9086),v=s(3567),j=s(93004),y=s(4382),N=s(47262);let S=g.Ik({email:g.Yj().email("Invalid email address."),password:g.Yj().min(1,"Password is required."),rememberMe:g.zM().optional()});function A(){let{toast:e}=(0,m.dj)(),{t}=(0,x.o)(),s=(0,b.useRouter)(),[r,g]=(0,u.useState)(!1),[A,T]=(0,u.useState)(!1),k="warriorwithinyousif@gmail.com",E=async a=>{let r=await (0,w.kl)(a);if(!r){e({title:t("toasts.error"),description:"No user data found in database.",variant:"destructive"}),T(!1);return}if("supervisor"===r.role&&r.trialExpiresAt&&(0,v.R)(new Date(r.trialExpiresAt))&&!r.isSuspended){r.isSuspended=!0,await (0,w.PF)(r),e({title:"Trial Expired",description:"Your trial period has ended. Please contact an administrator.",variant:"destructive"}),T(!1);return}if(r.isSuspended){e({title:t("toasts.error"),description:"This account has been suspended.",variant:"destructive"}),T(!1);return}s.push("/dashboard?userId=".concat(r.id))},I=async s=>{s.preventDefault(),T(!0);let a=new FormData(s.currentTarget),r=S.safeParse({email:a.get("email"),password:a.get("password"),rememberMe:"on"===a.get("remember-me")});if(!r.success){var i;let s=null==(i=Object.values(r.error.flatten().fieldErrors)[0])?void 0:i[0];e({title:t("toasts.error"),description:s||"Validation failed.",variant:"destructive"}),T(!1);return}let{email:n,password:o,rememberMe:l}=r.data;try{await (0,j.oM)(y.j,l?j.F0:j.iM);let e=await (0,j.x9)(y.j,n,o);await E(e.user.uid)}catch(s){if(("auth/user-not-found"===s.code||"auth/invalid-credential"===s.code)&&n===k&&"password123"===o)try{let e=await (0,j.eJ)(y.j,n,o),t=await (0,w.Li)(),s={id:e.user.uid,name:"Yousif",email:k,role:"supervisor",avatar:"https://placehold.co/100x100.png?text=Y",timezone:"Asia/Baghdad",isMainAdmin:!0,isSuspended:!1,shortId:t};await (0,w.tW)(s),await E(e.user.uid)}catch(t){e({title:"Admin Creation Error",description:"Failed to auto-create admin account: ".concat(t.message),variant:"destructive"}),T(!1)}else{console.error("Firebase Auth Error: ",s);let a="An unexpected error occurred. Please try again.";"auth/user-not-found"===s.code||"auth/wrong-password"===s.code||"auth/invalid-credential"===s.code?a="Invalid email or password. Please check your credentials or sign up if you don't have an account.":"auth/too-many-requests"===s.code&&(a="Access to this account has been temporarily disabled due to many failed login attempts. You can immediately restore it by resetting your password or you can try again later."),e({title:t("toasts.error"),description:a,variant:"destructive"}),T(!1)}}};return(0,a.jsxs)(o.Zp,{className:"mx-auto max-w-sm w-full",children:[(0,a.jsxs)(o.aR,{className:"text-center",children:[(0,a.jsx)("div",{className:"flex justify-center mb-4",children:(0,a.jsx)(c.g,{className:"h-20 w-20"})}),(0,a.jsx)(o.ZB,{className:"text-2xl font-headline",children:t("login.welcome")}),(0,a.jsx)(o.BT,{children:t("login.description")})]}),(0,a.jsxs)(o.Wu,{children:[(0,a.jsxs)("form",{onSubmit:I,className:"grid gap-4",children:[(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(d.J,{htmlFor:"email",children:t("login.emailLabel")}),(0,a.jsx)(l.p,{id:"email",type:"email",name:"email",placeholder:"m@example.com",required:!0})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsx)(d.J,{htmlFor:"password",children:t("login.passwordLabel")})}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(l.p,{id:"password",name:"password",type:r?"text":"password",required:!0}),(0,a.jsx)("button",{type:"button",onClick:()=>g(!r),className:"absolute inset-y-0 right-0 flex items-center px-3 text-muted-foreground hover:text-foreground","aria-label":r?"Hide password":"Show password",children:r?(0,a.jsx)(p.A,{className:"h-4 w-4"}):(0,a.jsx)(f.A,{className:"h-4 w-4"})})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(N.S,{id:"remember-me",name:"remember-me"}),(0,a.jsx)(d.J,{htmlFor:"remember-me",className:"text-sm font-medium leading-none",children:"Remember me"})]}),(0,a.jsx)(i(),{href:"#",className:"ms-auto inline-block text-sm underline",children:t("login.forgotPassword")})]}),(0,a.jsx)(n.$,{type:"submit",disabled:A,className:"w-full",children:A?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(h.A,{className:"me-2 h-4 w-4 animate-spin"}),t("login.loginButton"),"..."]}):t("login.loginButton")})]}),(0,a.jsxs)("div",{className:"mt-4 text-center text-sm",children:[t("login.noAccount")," ",(0,a.jsx)(i(),{href:"/register",className:"underline",children:t("login.signUp")})]})]})]})}},47262:(e,t,s)=>{s.d(t,{S:()=>l});var a=s(95155),r=s(12115),i=s(76981),n=s(10518),o=s(59434);let l=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(i.bL,{ref:t,className:(0,o.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",s),...r,children:(0,a.jsx)(i.C1,{className:(0,o.cn)("flex items-center justify-center text-current"),children:(0,a.jsx)(n.A,{className:"h-4 w-4"})})})});l.displayName=i.bL.displayName},62523:(e,t,s)=>{s.d(t,{p:()=>n});var a=s(95155),r=s(12115),i=s(59434);let n=r.forwardRef((e,t)=>{let{className:s,type:r,...n}=e;return(0,a.jsx)("input",{type:r,className:(0,i.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:t,...n})});n.displayName="Input"},85057:(e,t,s)=>{s.d(t,{J:()=>d});var a=s(95155),r=s(12115),i=s(40968),n=s(74466),o=s(59434);let l=(0,n.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(i.b,{ref:t,className:(0,o.cn)(l(),s),...r})});d.displayName=i.b.displayName},87481:(e,t,s)=>{s.d(t,{dj:()=>m});var a=s(12115);let r=0,i=new Map,n=e=>{if(i.has(e))return;let t=setTimeout(()=>{i.delete(e),c({type:"REMOVE_TOAST",toastId:e})},5e3);i.set(e,t)},o=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:s}=t;return s?n(s):e.toasts.forEach(e=>{n(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===s||void 0===s?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},l=[],d={toasts:[]};function c(e){d=o(d,e),l.forEach(e=>{e(d)})}function u(e){let{...t}=e,s=(r=(r+1)%Number.MAX_SAFE_INTEGER).toString(),a=()=>c({type:"DISMISS_TOAST",toastId:s});return c({type:"ADD_TOAST",toast:{...t,id:s,open:!0,onOpenChange:e=>{e||a()}}}),{id:s,dismiss:a,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:s}})}}function m(){let[e,t]=a.useState(d);return a.useEffect(()=>(l.push(t),()=>{let e=l.indexOf(t);e>-1&&l.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}}}]);